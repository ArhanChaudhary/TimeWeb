{% extends "template.html" %}
{% load static %}
{% block css %}
<link rel="stylesheet" href="{% static 'css/index.css' %}"></link>
{% endblock css %}
{% block js %}
<script src="{% static 'vendor/jquery.easing.js' %}"></script>
{{ data|json_script:"load-data" }}
<script src="{% static 'js/priority.js' %}"></script>
<script src="{% static 'js/graph.js' %}"></script>
<script src="{% static 'js/form.js' %}"></script>
<script src="{% static 'js/utils.js' %}"></script>
{% endblock js %}
{% block content %}
  <div id="overlay">
    <div id="form-wrapper">
      <form method="POST" autocomplete="off">
        <div id="new-title-line"></div>
        <div id="new-title">New Assignment</div>
        <div id="top-note">* optional</div>
        <div id="bottom-note">Tip: press enter to submit or keep pressing tab</div>
        {% csrf_token %}
        {% for field in form.visible_fields %}
          <p>
            {% if field.name == "nwd" %}
              <label id="nwd-label-title">Select the Weekdays you won't work on this Assignment</label>
              <div id="nwd-wrapper">
                {% for value, text in field.field.choices %}
                  <input {% if field.errors %}class="invalid"{% endif %} id="id_nwd_{{ forloop.counter0 }}" name="{{ field.name }}" type="checkbox" value="{{ value }}" {% if value in checked_nwd %}checked="checked"{% endif %}>
                  <label tabindex="0" class="nwd-label" for="id_nwd_{{ forloop.counter0 }}">{{ text }}</label>
                {% endfor %}
              </div>
            {% else %}
              {{ field.label_tag }}
              {{ field }}
            {% endif %}
            {% for error in field.errors %}
              <p class="error-note" id="error_{{ field.auto_id }}">{{ error|escape }}</p>
            {% endfor %}
          </p>
        {% endfor %}
        {% for hidden in form.hidden_fields %}
          {{ hidden }}
        {% endfor %}
        <button {% if invalid_form_pk %}value="{{ invalid_form_pk }}"{% endif %} type="submit" name="submit-button" title="(Enter)">{{submit}}</button>
      </form>
    </div>
  </div>
  <div id="assignments-container">
    <div id="info">
      Estimated total Completion time: <span>1h 24m</span>
      <button id="hide-button">Hide</button>
    </div>
    {% for obj in objlist %}
      <div class="assignment-container" {% if obj.file_sel == request.session.added_assignment %}id="animate-in"{% elif obj.file_sel == request.session.reentered_assignment %}id="animate-color"{% endif %}>
        <div class="assignment" tabindex="0">
          <div class="assignment-header">
            <span class="title">
              {{ obj.file_sel }}
              <p class="daysleft">1d</p>
            </span>
            <svg width="30px" height="20px" class="arrow-container">
              <polygon class="arrow" points="5,0 5,20 15,10">
                <animate class="risingarrowanimation" begin="indefinite" fill="freeze" attributeName="points" dur="100ms" to="20,5 0,5 10,15"></animate>
                <animate class="fallingarrowanimation" begin="indefinite" fill="freeze" attributeName="points" dur="100ms" to="5,0 5,20 15,10"></animate>
              </polygon>
            </svg>
            <p class="status">Nice Job! You are Finished with this Assignment for Today. Keep it up!</p>
            <button value="{{ obj.pk }}" class="button update-button">
              <img height="20" src="{% static 'images/edit.png' %}" alt="delete" draggable="false"/>
            </button>
            <button value="{{ obj.pk }}" class="button delete-button">
              <img height="22" src="{% static 'images/delete.png' %}" alt="edit" draggable="false"/>
            </button>
          </div>
          <div class="relative-positioning-wrapper">
            <div class="graph-container">
              <canvas class="fixed-graph"></canvas>
              <canvas value="{{ obj.pk }}" tabindex="0" class="graph">Your browser does not support the canvas tag.</canvas>
              <div class="graph-footer">
                <button class="sr-button">Set skew ratio using graph</button>
                <input class="work-input" placeholder="Enter work done"/>
                {% comment %} float:right breaks everything {% endcomment %}
                <button class="fixed-mode-button">Switch to fixed mode</button>
                <br>
                <input type="number" step="0.1" placeholder="Enter skew ratio" class="sr-textbox"/>
                <input class="total-work-input" placeholder="Enter total work done"/>
                <button class="remainder-mode-button">Enable remainder mode</button>
                <br>
                <button class="next-assignment-button">Hide assignment</button>
                <button class="display-button">Display work schedule in text</button>
                {% comment %} click again to confirm, 1s window to click {% endcomment %}
                <button class="delete-input-button">Delete latest work input</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
  <style id="assignment-hover-width"></style>
{% endblock content %}