{% extends "template.html" %}
{% load static %}
{% block css %}
<link rel="stylesheet" href="{% static 'css/index.css' %}">
{% endblock css %}
{% block js %}
{{ assignment_models|json_script:"assignment-models" }}
{% comment %} 
[{"id": 143, "file_sel": "Math \"homework\"", "ad": "2021-04-22", "x": "2021-05-07", "unit": "maths problem", "y": "71.00", "works": ["0", "0", "0", "0", "0", "0", "0", "0", "0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "5.00", "funct_round": "1.00", "min_work_time": null, "nwd": ["4", "0"], "fixed_mode": false, "dynamic_start": 7, "user_id": 7}] {% endcomment %}
{{ settings_model|json_script:"settings-model" }}
<script src="{% static 'vendor/pluralize.js' %}"></script>
<script src="{% static 'vendor/jquery.easing.min.js' %}"></script>
<script src="{% static 'js/utils.js' %}"></script>
<script src="{% static 'js/priority.js' %}"></script>
<script src="{% static 'js/parabola.js' %}"></script>
<script src="{% static 'js/graph.js' %}"></script>
<script src="{% static 'js/form.js' %}"></script>
{% endblock js %}
{% block content %}
  <div id="overlay">
    <div id="form-wrapper">
      <form method="POST" autocomplete="off">
        <img id="cancel-button" width="45" height="45" src="{% static 'images/x.png' %}" alt="cancel" draggable="false" tabindex="0">
        <div id="new-title-line"></div>
        <div id="new-title">New Assignment</div>
        <div id="top-note">* optional</div>
        {% csrf_token %}
        {% for field in form.visible_fields %}
          <p>
            {% if field.name == "nwd" %}
              <label id="nwd-label-title">Select the Days you won't work on this Assignment</label>
              <div id="nwd-wrapper">
                {% for value, text in field.field.choices %}
                  <input id="id_nwd_{{ forloop.counter0 }}" name="{{ field.name }}" type="checkbox" value="{{ value }}" {% if value in checked_nwd %}checked="checked"{% endif %}>
                  <label tabindex="0" class="nwd-label" for="id_nwd_{{ forloop.counter0 }}">{{ text }}</label>
                {% endfor %}
              </div>
            {% else %}
              {{ field.label_tag }}
              {{ field }}
            {% endif %}
            {% for error in field.errors %}
              <p class="error-note" id="error_{{ field.auto_id }}">{{ error|escape }}</p>
            {% endfor %}
          </p>
        {% endfor %}
        {% for hidden in form.hidden_fields %}
          {{ hidden }}
        {% endfor %}
        <button {% if invalid_form_pk %}value="{{ invalid_form_pk }}"{% endif %} type="submit" name="submit-button" id="submit-assignment-button" title="(Enter)">{{submit}}</button>
      </form>
    </div>
  </div>
  <div id="assignments-container">
    <div id="assignments-header">
      <div id="info">
        Estimated completion time: <span id="estimated-total-time"></span><span id="current-time"></span><span id="tomorrow-time"></span>
        <button id="hide-button">Hide</button>
      </div>
      <div id="advanced" tabindex="0">
        Advanced
        <svg width="15px" height="10px">
          <polygon class="arrow" points="10,2.5 0,2.5 5,7.5">
          </polygon>
        </svg>
        <div id="advanced-options">
          <span id="open-assignments" tabindex="0">Open all assignments</span>
          <span id="close-assignments" tabindex="0">Close all assignments</span>
          <span id="autofill-assignments" tabindex="0">Autofill no work done</span>
          <span id="delete-assignments" tabindex="0">Delete all completed<br>assignments</span>
          <span id="re-enable-tutorial" tabindex="0">Re-enable tutorial</span>
        </div>
      </div>
    </div>
    {% for obj in objlist %}
      <div class="assignment-container" {% if obj.file_sel == request.session.added_assignment %}id="animate-in"{% elif obj.file_sel == request.session.reentered_assignment %}id="animate-color"{% endif %}>
        <div class="assignment" data-assignment-name="{{ obj.file_sel }}" tabindex="0">
          <div class="assignment-header">
            <span class="title" data-daysleft="1d">{{ obj.file_sel }}</span>
            <svg width="30px" height="20px" class="arrow-container">
              <polygon class="arrow" points="5,0 5,20 15,10">
                <animate class="risingarrowanimation" begin="indefinite" fill="freeze" attributeName="points" dur="100ms" to="20,5 0,5 10,15"></animate>
                <animate class="fallingarrowanimation" begin="indefinite" fill="freeze" attributeName="points" dur="100ms" to="5,0 5,20 15,10"></animate>
              </polygon>
            </svg>
            <p class="status">
              <span class="status-message"></span>
              <span class="completion-time"></span>
            </p>
            <button class="button update-button">
              <img width="20" height="20" src="{% static 'images/edit.png' %}" alt="delete" draggable="false"/>
            </button>
            <button class="button delete-button">
              <img width="19" height="22" src="{% static 'images/delete.png' %}" alt="edit" draggable="false"/>
            </button>
          </div>
          <div class="relative-positioning-wrapper">
            <div class="graph-container">
              <canvas class="fixed-graph"></canvas>
              <canvas tabindex="0" class="graph">Your browser does not support the canvas tag.</canvas>
              <div class="graph-footer">
                <button class="skew-ratio-button">Set skew ratio using Graph</button>
                <input class="total-work-input-button" placeholder="Enter total units done"/>
                <button class="display-button">Display in Text</button>
                <br>
                <input type="number" step="0.1" placeholder="Enter skew ratio" class="skew-ratio-textbox"/>
                <button class="submit-work-button">Submit work Input</button>
                <button class="hide-assignment-button">Hide Assignment</button>
                <br>
                <button class="fixed-mode-button"></button>
                <button class="delete-work-input-button">Delete last work Input</button>              
                <button class="next-assignment-button">Next Assignment</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% endblock content %}