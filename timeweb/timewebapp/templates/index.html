{% extends "template.html" %}
{% load static %}
{% block css %}
<link rel="stylesheet" href="{% static 'css/index.css' %}">
{% endblock css %}
{% block js %}
{{ assignment_models_as_json|json_script:"assignment-models" }}
{{ settings_model_as_json|json_script:"settings-model" }}
<script src="{% static 'vendor/pluralize.js' %}"></script>
<script src="{% static 'vendor/jquery.easing.min.js' %}"></script>
<script src="{% static 'js/utils.js' %}"></script>
<script src="{% static 'js/priority.js' %}"></script>
<script src="{% static 'js/parabola.js' %}"></script>
<script src="{% static 'js/graph.js' %}"></script>
<script src="{% static 'js/crud.js' %}"></script>
{% endblock js %}

{% block content %}
  <div id="overlay">
    <div id="form-wrapper">
      <form method="POST" autocomplete="off">
        <img id="cancel-button" class="button" width="45" height="45" src="{% static 'images/x.png' %}" alt="cancel" draggable="false" tabindex="0">
        <div id="new-title-line"></div>
        <div id="new-title">New Assignment</div>
        {% csrf_token %}
        {% for field in form.visible_fields %}
          <p>
            {% if field.name == "break_days" %}
              <label id="break-days-label-title">Break Days</label>
              <div id="break-days-wrapper">
                {% for value, text in field.field.choices %}
                  <input id="id_break_days_{{ forloop.counter0 }}" name="{{ field.name }}" type="checkbox" value="{{ value }}" {% if value in checked_break_days %}checked="checked"{% endif %}>
                  <label tabindex="0" class="break-days-label" for="id_break_days_{{ forloop.counter0 }}">{{ text }}</label>
                {% endfor %}
              </div>
            {% else %}
              {{ field.label_tag }}
              {{ field }}
            {% endif %}
            {% for error in field.errors %}
              <p class="error-note" id="error_{{ field.auto_id }}">{{ error|escape }}</p>
            {% endfor %}
          </p>
        {% endfor %}
        {% for hidden in form.hidden_fields %}
          {{ hidden }}
        {% endfor %}
        <div id="advanced-inputs" tabindex="0">
          Advanced Inputs
          <svg width="15px" height="10px">
            <polygon class="arrow" points="10,2.5 0,2.5 5,7.5">
            </polygon>
          </svg>
        </div>
        <button {% if invalid_form_pk %}value="{{ invalid_form_pk }}"{% endif %} type="submit" name="submit-button" id="submit-assignment-button" title="(Enter)">{{submit}}</button>
      </form>
    </div>
  </div>
  <div id="assignments-container">
    <div id="assignments-header">
      <div id="info">
        Estimated completion time: <span id="estimated-total-time"></span><span id="current-time"></span><span id="tomorrow-time"></span>
        <button id="hide-button">Hide</button>
      </div>
      <div id="advanced" tabindex="0">
        Advanced
        <svg width="15px" height="10px">
          <polygon class="arrow" points="10,2.5 0,2.5 5,7.5">
          </polygon>
        </svg>
        <div id="advanced-options" class="hidden">
          <span id="next-day" tabindex="0">Go to Next Day</span>
          <span id="open-assignments" tabindex="0">Open all Assignments</span>
          <span id="close-assignments" tabindex="0">Close all Assignments</span>
          <span id="re-enable-tutorial" tabindex="0">Re-enable Tutorial</span>
        </div>
      </div>
    </div>
    <div id="simulated-date"></div>
    <div id="autofill-work-done">
      <div class="shortcut-line-right"></div>
      <div class="shortcut-line-left"></div>
      <span id="autofill-work-done-text" class="shortcut-text">
        Autofill
        <select id="autofill-selection">
          <option>No</option>
          <option>All</option>
        </select>
        Work Done
      </span>
    </div>
    <div id="delete-starred-assignments">
      <div class="shortcut-line-right"></div>
      <div class="shortcut-line-left"></div>
      <span id="delete-starred-assignments-text" class="shortcut-text">Delete all Starred Assignments</span>
    </div>
    {% for assignment in assignment_models %}
      <div class="assignment-container" {% if assignment.assignment_name == request.session.added_assignment %}id="animate-in"{% elif assignment.assignment_name == request.session.reentered_assignment %}id="animate-color"{% endif %}>
        <div class="assignment" data-assignment-name="{{ assignment.assignment_name }}" tabindex="0">
          <div class="assignment-header">
            <span class="title">{{ assignment.assignment_name }}</span>
            <svg width="30px" height="20px" class="arrow-container">
              <polygon class="arrow" points="5,0 5,20 15,10">
                <animate class="risingarrowanimation" begin="indefinite" fill="freeze" attributeName="points" dur="100ms" to="20,5 0,5 10,15"></animate>
                <animate class="fallingarrowanimation" begin="indefinite" fill="freeze" attributeName="points" dur="100ms" to="5,0 5,20 15,10"></animate>
              </polygon>
            </svg>
            <p class="status">
              <img class="status-image">
              <span class="status-message"></span>
              <span class="completion-time"></span>
            </p>
            <img class="button update-button" width="45" height="45" src="{% static 'images/edit.png' %}" alt="delete" draggable="false"/>
            <img class="button delete-button" width="45" height="45" src="{% static 'images/x.png' %}" alt="edit" draggable="false"/>
          </div>
          <div class="relative-positioning-wrapper">
            <div class="graph-container">
              <canvas class="fixed-graph"></canvas>
              <canvas class="graph">Your browser does not support the canvas tag.</canvas>
              <div class="graph-footer">
                <button class="delete-work-input-button">Delete Work Input</button>
                <input class="work-input-button" placeholder="Enter Units Done"/>
                <button class="submit-work-button">Submit Work Input</button>
                <br>
                <button class="display-button">Display in Text</button>
                <button class="mark-as-finished-button"></button>
                <button class="next-assignment-button">Next Assignment</button>
                <br>
                <div class="advanced-buttons">
                  Advanced Buttons
                  <svg width="15px" height="10px">
                    <polygon class="arrow" points="10,2.5 0,2.5 5,7.5"></polygon>
                  </svg>
                </div>
                <button class="skew-ratio-button">Set Skew Ratio using Graph</button>
                <input type="number" step="0.1" placeholder="Enter Skew Ratio" class="skew-ratio-textbox"/>
                <button class="fixed-mode-button"></button>
                <div class="advanced-buttons second-advanced-button">
                  Advanced Buttons
                  <svg width="15px" height="10px">
                    <polygon class="arrow" points="10,10 0,10 5,5"></polygon>
                  </svg>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% endblock content %}