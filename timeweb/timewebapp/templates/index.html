{% extends "template.html" %}
{% load static %}
{% block css %}
<link rel="stylesheet" href="{% static 'css/index.css' %}">
{% endblock css %}
{% block js %}
{{ assignment_models|json_script:"assignment-models" }}
{% comment %} 



scroller load:
uncomment line in utils.js
$ python manage.py shell
>>> def load_scroller(user_id):

  dat_json = '[{"id": 460, "assignment_name": "Summer Internship", "ad": "2021-06-15", "x": "2021-08-15", "unit": "Minute", "y": "2000.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "5.00", "min_work_time": null, "nwd": ["5", "6", "0"], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 461, "assignment_name": "Work on Birthday Card", "ad": "2021-05-03", "x": "2021-05-06", "unit": "1", "y": "1.00", "works": ["0", "1"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "1.00", "min_work_time": null, "nwd": [], "fixed_mode": false, "dynamic_start": 1, "mark_as_done": false, "user_id": 13}, {"id": 462, "assignment_name": "Science Lab", "ad": "2021-05-03", "x": "2021-05-05", "unit": "Question", "y": "6.00", "works": ["0", "0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "6.00", "funct_round": "1.00", "min_work_time": null, "nwd": ["5", "6", "0"], "fixed_mode": true, "dynamic_start": 1, "mark_as_done": false, "user_id": 13}, {"id": 463, "assignment_name": "Club Lecture", "ad": "2021-05-03", "x": "2021-05-31", "unit": "Google Slide", "y": "20.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "30.00", "funct_round": "1.00", "min_work_time": null, "nwd": ["5", "6", "0"], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 464, "assignment_name": "Play Rehearsal", "ad": "2021-05-03", "x": "2021-05-23", "unit": "Minute", "y": "475.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "4.0000000000", "ctime": "1.00", "funct_round": "5.00", "min_work_time": "120.00", "nwd": ["5", "6", "0"], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 465, "assignment_name": "Pg. 364 #23 - 53 odd", "ad": "2021-05-03", "x": "2021-05-05", "unit": "Problem", "y": "16.00", "works": ["0", "0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "3.00", "funct_round": "5.00", "min_work_time": null, "nwd": [], "fixed_mode": true, "dynamic_start": 1, "mark_as_done": false, "user_id": 13}, {"id": 466, "assignment_name": "Finish writing Blog", "ad": "2021-05-03", "x": "2021-05-10", "unit": "Minute", "y": "45.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "5.00", "min_work_time": null, "nwd": ["5", "6", "0"], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 467, "assignment_name": "Math Extra Credit Worksheet", "ad": "2021-05-03", "x": "2021-05-07", "unit": "5", "y": "5.00", "works": ["0", "1"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "5.00", "funct_round": "1.00", "min_work_time": null, "nwd": [], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 468, "assignment_name": "Finish Email", "ad": "2021-05-03", "x": "2021-05-04", "unit": "Minute", "y": "15.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "5.00", "min_work_time": null, "nwd": [], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 469, "assignment_name": "Book for English Class", "ad": "2021-05-03", "x": "2021-05-14", "unit": "Page", "y": "300.00", "works": ["30"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "3.00", "funct_round": "5.00", "min_work_time": null, "nwd": ["5", "6", "0"], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 470, "assignment_name": "Driving Practice", "ad": "2021-05-03", "x": "2021-09-05", "unit": "Minute", "y": "1000.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "5.00", "min_work_time": "60.00", "nwd": ["5", "6", "0"], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 471, "assignment_name": "SAT Prep", "ad": "2021-05-03", "x": "2021-08-31", "unit": "Minute", "y": "2400.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "5.00", "min_work_time": "30.00", "nwd": ["5", "6", "0"], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 472, "assignment_name": "Pg. 109 #10 - 21", "ad": "2021-05-03", "x": "2021-05-08", "unit": "Question", "y": "12.00", "works": ["0", "12"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "1.00", "min_work_time": null, "nwd": [], "fixed_mode": false, "dynamic_start": 1, "mark_as_done": false, "user_id": 13}, {"id": 473, "assignment_name": "Marketing Homework", "ad": "2021-05-03", "x": "2021-05-05", "unit": "Minute", "y": "50.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "5.00", "min_work_time": null, "nwd": [], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 474, "assignment_name": "Study for Math Test", "ad": "2021-05-03", "x": "2021-05-11", "unit": "Minute", "y": "220.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "5.00", "min_work_time": "20.00", "nwd": ["5", "6", "0"], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 475, "assignment_name": "Spanish Project", "ad": "2021-05-03", "x": "2021-05-13", "unit": "Minute", "y": "300.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "5.00", "min_work_time": null, "nwd": ["5", "6", "0"], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 476, "assignment_name": "Learn the Rubik\'s Cube", "ad": "2021-05-03", "x": "2021-05-31", "unit": "Minute", "y": "720.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "5.00", "min_work_time": "60.00", "nwd": [], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 477, "assignment_name": "Run PE Mile", "ad": "2021-05-03", "x": "2021-05-04", "unit": "Minute", "y": "10.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "5.00", "min_work_time": null, "nwd": [], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 478, "assignment_name": "Crossword Puzzle", "ad": "2021-05-03", "x": "2021-05-04", "unit": "Crossword", "y": "20.00", "works": ["3"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "1.00", "min_work_time": null, "nwd": ["5", "6", "0"], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 479, "assignment_name": "Summer Reading Book", "ad": "2021-06-15", "x": "2021-07-15", "unit": "Page", "y": "1.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "1.00", "min_work_time": null, "nwd": [], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 480, "assignment_name": "Smoke Signal Article", "ad": "2021-05-03", "x": "2021-05-12", "unit": "Minute", "y": "680.00", "works": ["0", "0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "5.00", "min_work_time": null, "nwd": ["5", "6", "0"], "fixed_mode": true, "dynamic_start": 1, "mark_as_done": false, "user_id": 13}, {"id": 481, "assignment_name": "History Presentation", "ad": "2021-05-03", "x": "2021-05-06", "unit": "Google Slide", "y": "8.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "11.50", "funct_round": "1.00", "min_work_time": null, "nwd": ["5", "6", "0"], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 482, "assignment_name": "English Work Packet", "ad": "2021-05-03", "x": "2021-05-07", "unit": "Problem", "y": "30.00", "works": ["0", "4"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "6.50", "funct_round": "1.00", "min_work_time": null, "nwd": ["5", "6", "0"], "fixed_mode": true, "dynamic_start": 1, "mark_as_done": false, "user_id": 13}, {"id": 483, "assignment_name": "Art Project", "ad": "2021-05-03", "x": "2021-05-06", "unit": "Minute", "y": "60.00", "works": ["0", "10"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "1.00", "funct_round": "5.00", "min_work_time": null, "nwd": ["5", "6", "0"], "fixed_mode": true, "dynamic_start": 1, "mark_as_done": false, "user_id": 13}, {"id": 484, "assignment_name": "History Group Project", "ad": "2021-05-03", "x": "2021-05-14", "unit": "Page", "y": "5.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "20.00", "funct_round": "1.00", "min_work_time": null, "nwd": [], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}, {"id": 485, "assignment_name": "Web Development Course", "ad": "2021-05-03", "x": "2021-06-08", "unit": "Minute", "y": "400.00", "works": ["0"], "dif_assign": 0, "skew_ratio": "2.3013381036", "ctime": "1.00", "funct_round": "5.00", "min_work_time": "30.00", "nwd": [], "fixed_mode": false, "dynamic_start": 0, "mark_as_done": false, "user_id": 13}]'
  settings_json = '{"id": 30, "warning_acceptance": 50, "def_min_work_time": null, "def_skew_ratio": "1.0000000000", "def_nwd": [], "def_funct_round_minute": true, "ignore_ends": false, "show_progress_bar": false, "show_info_buttons": true, "show_past": true, "color_priority": true, "text_priority": true, "first_login": false, "date_now": "2021-05-03"}'

  import json
  from timewebapp.models import TimewebModel, SettingsModel
  
  TimewebModel.objects.filter(user_id=user_id).delete()
  SettingsModel.objects.get(user_id=user_id).delete()

  dat_json = json.loads(dat_json)
  settings_json = json.loads(settings_json)
  for model in dat_json:
    del model['id']
    model['user_id'] = user_id
    TimewebModel.objects.create(**model)
  del settings_json['id']
  settings_json['user_id'] = user_id
  SettingsModel.objects.create(**settings_json)
>>> load_scroller({id of scroller user})
>>> quit()
$ python manage.py runserver


[{"id": 143, "assignment_name": "Math \"homework\"", "ad": "2021-04-22", "x": "2021-05-07", "unit": "maths problem", "y": "71.00", "works": ["0", "0", "0", "0", "0", "0", "0", "0", "0"], "dif_assign": 0, "skew_ratio": "1.0000000000", "ctime": "5.00", "funct_round": "1.00", "min_work_time": null, "nwd": ["4", "0"], "fixed_mode": false, "dynamic_start": 7, "user_id": 7}] {% endcomment %}
{{ settings_model|json_script:"settings-model" }}
<script src="{% static 'vendor/pluralize.js' %}"></script>
<script src="{% static 'vendor/jquery.easing.min.js' %}"></script>
<script src="{% static 'js/utils.js' %}"></script>
<script src="{% static 'js/priority.js' %}"></script>
<script src="{% static 'js/parabola.js' %}"></script>
<script src="{% static 'js/graph.js' %}"></script>
<script src="{% static 'js/form.js' %}"></script>
{% endblock js %}
{% block content %}
  <div id="overlay">
    <div id="form-wrapper">
      <form method="POST" autocomplete="off">
        <img id="cancel-button" class="button" width="45" height="45" src="{% static 'images/x.png' %}" alt="cancel" draggable="false" tabindex="0">
        <div id="new-title-line"></div>
        <div id="new-title">New Assignment</div>
        {% csrf_token %}
        {% for field in form.visible_fields %}
          <p>
            {% if field.name == "nwd" %}
              <label id="nwd-label-title">Break Days</label>
              <div id="nwd-wrapper">
                {% for value, text in field.field.choices %}
                  <input id="id_nwd_{{ forloop.counter0 }}" name="{{ field.name }}" type="checkbox" value="{{ value }}" {% if value in checked_nwd %}checked="checked"{% endif %}>
                  <label tabindex="0" class="nwd-label" for="id_nwd_{{ forloop.counter0 }}">{{ text }}</label>
                {% endfor %}
              </div>
            {% else %}
              {{ field.label_tag }}
              {{ field }}
            {% endif %}
            {% for error in field.errors %}
              <p class="error-note" id="error_{{ field.auto_id }}">{{ error|escape }}</p>
            {% endfor %}
          </p>
        {% endfor %}
        {% for hidden in form.hidden_fields %}
          {{ hidden }}
        {% endfor %}
        <div id="advanced-inputs" tabindex="0">
          Advanced Inputs
          <svg width="15px" height="10px">
            <polygon class="arrow" points="10,2.5 0,2.5 5,7.5">
            </polygon>
          </svg>
        </div>
        <button {% if invalid_form_pk %}value="{{ invalid_form_pk }}"{% endif %} type="submit" name="submit-button" id="submit-assignment-button" title="(Enter)">{{submit}}</button>
      </form>
    </div>
  </div>
  <div id="assignments-container">
    <div id="assignments-header">
      <div id="info">
        Estimated completion time: <span id="estimated-total-time"></span><span id="current-time"></span><span id="tomorrow-time"></span>
        <button id="hide-button">Hide</button>
      </div>
      <div id="advanced" tabindex="0">
        Advanced
        <svg width="15px" height="10px">
          <polygon class="arrow" points="10,2.5 0,2.5 5,7.5">
          </polygon>
        </svg>
        <div id="advanced-options" class="hidden">
          <span id="open-assignments" tabindex="0">Open all Assignments</span>
          <span id="close-assignments" tabindex="0">Close all Assignments</span>
          <span id="autofill-assignments" tabindex="0">Autofill No Work Done</span>
          <span id="delete-assignments" tabindex="0">Delete all Completed<br>Assignments</span>
          <span id="next-day" tabindex="0">Go to Next Day</span>
          <span id="re-enable-tutorial" tabindex="0">Re-enable Tutorial</span>
        </div>
      </div>
    </div>
    {% for assignment in assignmentlist %}
      <div class="assignment-container" {% if assignment.assignment_name == request.session.added_assignment %}id="animate-in"{% elif assignment.assignment_name == request.session.reentered_assignment %}id="animate-color"{% endif %}>
        <div class="assignment" data-assignment-name="{{ assignment.assignment_name }}" tabindex="0">
          <div class="assignment-header">
            <span class="title">{{ assignment.assignment_name }}</span>
            <svg width="30px" height="20px" class="arrow-container">
              <polygon class="arrow" points="5,0 5,20 15,10">
                <animate class="risingarrowanimation" begin="indefinite" fill="freeze" attributeName="points" dur="100ms" to="20,5 0,5 10,15"></animate>
                <animate class="fallingarrowanimation" begin="indefinite" fill="freeze" attributeName="points" dur="100ms" to="5,0 5,20 15,10"></animate>
              </polygon>
            </svg>
            <p class="status">
              <img class="status-image">
              <span class="status-message"></span>
              <span class="completion-time"></span>
            </p>
            <img class="button update-button" width="45" height="45" src="{% static 'images/edit.png' %}" alt="delete" draggable="false"/>
            <img class="button delete-button" width="45" height="45" src="{% static 'images/x.png' %}" alt="edit" draggable="false"/>
          </div>
          <div class="relative-positioning-wrapper">
            <div class="graph-container">
              <canvas class="fixed-graph"></canvas>
              <canvas tabindex="0" class="graph">Your browser does not support the canvas tag.</canvas>
              <div class="graph-footer">
                <button class="skew-ratio-button">Set skew ratio using Graph</button>
                <input class="total-work-input-button" placeholder="Enter total units done"/>
                <button class="display-button">Display in Text</button>
                <br>
                <input type="number" step="0.1" placeholder="Enter skew ratio" class="skew-ratio-textbox"/>
                <button class="submit-work-button">Submit work Input</button>
                <button class="hide-assignment-button"></button>
                <br>
                <button class="fixed-mode-button"></button>
                <button class="delete-work-input-button">Delete last work Input</button>              
                <button class="next-assignment-button">Next Assignment</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% endblock content %}